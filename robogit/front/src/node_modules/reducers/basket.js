import R from 'ramda'
import $ from 'jquery'

import {
  ADD_INFORMATION_TO_BASKET,
  REMOVE_INFORMATION_FROM_BASKET,
  CLEAN_BASKET,
  FETCH_BASKET_SUCCESS
} from 'actionTypes'

const initialState = [];

export default (state = initialState, {type, payload}) => {
    switch (type) {
        case FETCH_BASKET_SUCCESS:
            return payload;
        case ADD_INFORMATION_TO_BASKET:
        const data = {
            partId: payload,
            amount: 1
        };
        $.ajax({
            type: 'POST',
            url: 'http://robogit.org:8080/api/card/add',
            data: data
        });
        return R.append(payload, state);
    case REMOVE_INFORMATION_FROM_BASKET:
        const data_ = {
            partId: payload
        };
        $.ajax({
            type: 'POST',
            url: 'http://robogit.org:8080/api/card/remove',
            data: data_
        });
      return R.without(R.of(payload), state);
    case CLEAN_BASKET:
        $.ajax({
            type: 'POST',
            url: 'http://robogit.org:8080/api/card/clean',
        });
      return [];
    default:
      return state;
  }
}
